---
import AirfoilLayout from '../../layouts/AirfoilLayout.astro';
import AirfoilBanner from '../../components/airfoil/AirfoilBanner.astro';
import AirfoilTabs from '../../components/airfoil/AirfoilTabs.astro';
import MetadataCard from '../../components/airfoil/MetadataCard.astro';
import WingletConfigCard from '../../components/airfoil/WingletConfigCard.astro';
import CoordinateDataCard from '../../components/airfoil/CoordinateDataCard.astro';
import Model3DCard from '../../components/airfoil/Model3DCard.astro';
import PerformanceCard from '../../components/airfoil/PerformanceCard.astro';
import DragPolarCard from '../../components/airfoil/DragPolarCard.astro';
import StructuralPropertiesCard from '../../components/airfoil/StructuralPropertiesCard.astro';

import airfoils from '../../data/airfoils.json';

export const prerender = true;

export async function getStaticPaths() {
  return Object.keys(airfoils).map((id) => ({ params: { id } }));
}

const { id } = Astro.params;
const airfoil = airfoils[id];

if (!airfoil) {
  throw new Error(`Airfoil not found for ID: ${id}`);
}

// Extract airfoil family, camber and thickness from name (for NACA airfoils)
let airfoilFamily = 'Unknown';
let camber = '0';
let camberPosition = '0';
let thickness = '12';

if (airfoil.name.startsWith('NACA')) {
  airfoilFamily = 'NACA';
  
  // For 4-digit NACA airfoils
  if (airfoil.name.slice(5).length === 4) {
    camber = airfoil.name.slice(5, 6);
    camberPosition = airfoil.name.slice(6, 7);
    thickness = airfoil.name.slice(7, 9);
  }
}
---

<AirfoilLayout title={`${airfoil.name} - AeroFoilPro`}>
  <!-- Removed Breadcrumb Navigation as requested -->
  
  <AirfoilBanner name={airfoil.name} description={airfoil.description} />
  
  <AirfoilTabs />
  
  <div id="geometry-content" class="airfoil-tab-content active">
    <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left Column -->
      <div class="lg:col-span-2 space-y-6">
        <CoordinateDataCard coordinates={airfoil.coordinates} />
		<MetadataCard name={airfoil.name} />
        <StructuralPropertiesCard name={airfoil.name} />
      </div>
      
      <!-- Right Column -->
      <div class="space-y-6">
        <Model3DCard name={airfoil.name} coordinates={airfoil.coordinates} />
        <PerformanceCard name={airfoil.name} />
        <DragPolarCard name={airfoil.name} />
      </div>
    </div>
  </div>
  
  <div id="performance-content" class="airfoil-tab-content">
    <div class="mt-6">
      <PerformanceCard name={airfoil.name} />
    </div>
  </div>
  
  <div id="polar-content" class="airfoil-tab-content">
    <div class="mt-6">
      <DragPolarCard name={airfoil.name} />
    </div>
  </div>
  
  <div id="structural-content" class="airfoil-tab-content">
    <div class="mt-6">
      <StructuralPropertiesCard name={airfoil.name} />
    </div>
  </div>
  
    <div id="winglets-content" class="airfoil-tab-content">
    <div class="mt-6">
      <WingletConfigCard airfoilName={airfoil.name} />
    </div>
  </div>
  
  <div id="3d-content" class="airfoil-tab-content">
    <div class="mt-6">
      <Model3DCard name={airfoil.name} coordinates={airfoil.coordinates} />
    </div>
  </div>
</AirfoilLayout>